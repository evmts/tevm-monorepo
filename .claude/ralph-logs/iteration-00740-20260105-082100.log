# Ralph Migration Log - Iteration 740
## Date: 2026-01-05

## Task: Migrate Client type import from viem to @tevm/utils in createOptimisticHandler.ts

## Summary

Successfully migrated `Client` type import in bundler-packages/mud/src/createOptimisticHandler.ts from viem to @tevm/utils.

## Changes Made

### bundler-packages/mud/src/createOptimisticHandler.ts
- Moved `Client` type import from `viem` to `@tevm/utils`
- Before:
  ```typescript
  import { type Address, createAddressFromString } from '@tevm/utils'
  import { bytesToHex, type Client, type Hex, parseEventLogs } from 'viem'
  ```
- After:
  ```typescript
  import { type Address, bytesToHex, type Client, createAddressFromString, type Hex, parseEventLogs } from '@tevm/utils'
  ```

Note: Previous iterations already migrated `bytesToHex`, `Hex`, and `parseEventLogs` from viem to @tevm/utils. This iteration consolidates the `Client` type import with them.

## Remaining viem imports in createOptimisticHandler.ts

1. `getTransaction` from `viem/actions` - This is a viem action function, not yet available in @tevm/utils

## Type Compatibility Notes

The @tevm/utils `Client` type and viem's `Client` type have subtle differences in their EIP1193RequestFn type parameter signatures. This causes TypeScript errors when passing to functions that expect viem's specific types.

Pre-existing TypeScript errors in this package:
- `mudStoreWriteRequestOverride.spec.ts` - Client type incompatibility
- `prepare.ts` - Account type incompatibility (NativePrivateKeyAccount vs viem Account)
- `createOptimisticHandler.spec.ts` - Client type incompatibility with SessionClient union

The error at line 239 (`transport` parameter to `mudStoreGetStorageAtOverride`) is a manifestation of the Client type incompatibility between @tevm/utils and viem's types.

## Impact

- Reduced 1 viem type import
- Runtime behavior unchanged (both Client types have the same runtime structure)
- Pre-existing type errors remain (not introduced by this change)

## Notes

1. The migration is correct at the JavaScript level
2. Type-level incompatibilities exist because @tevm/utils Client was modeled after viem but has slight signature differences
3. To fully resolve type issues, the function signatures in mudStoreGetStorageAtOverride would need to use @tevm/utils types
4. Test failures (InvalidGasLimitError) are pre-existing and unrelated to this change

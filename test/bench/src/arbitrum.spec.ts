import { ERC721 } from '@openzeppelin/contracts/token/ERC721/ERC721.sol'
import { createMemoryClient, http } from 'tevm'
import { arbitrum } from 'tevm/common'
import { expect, it } from 'vitest'

const smolContract = ERC721.withAddress('0xa7f1462e0ecdeebdee4faf6681148ca96db78777')

it('can fork arbitrum', async () => {
	const client = createMemoryClient({
		loggingLevel: 'info',

		common: arbitrum,
		fork: {
			transport: http('https://arb1.arbitrum.io/rpc')({ retryCount: 3 }),
		},
	})

	expect(await client.readContract(smolContract.read.tokenURI(1n))).toEqual(
		[
			'data:application/json;base64,eyJkZXNjcmlwdGlvbiI6ICJTbW9sIEJyYWlucyIsImltYWdlIjogImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIaHRiRzV6T25oc2',
			'FXNXJQU0pvZEhSd09pOHZkM2QzTG5jekxtOXlaeTh4T1RrNUwzaHNhVzVySWlCcFpEMGljMjF2YkNJZ2QybGtkR2c5SWpFd01DVWlJR2hsYVdkb2REMGlNVEF3SlNJZ2RtVnljMmx2YmowaU1TNHhJaUIyYVdWM1FtOTRQU0l3SURBZ016WXdJRE0yTUNJZ2MzUjViR1U5SW',
			'1KaFkydG5jbTkxYm1RdFkyOXNiM0k2SUhSeVlXNXpjR0Z5Wlc1ME8ySmhZMnRuY205MWJtUXRhVzFoWjJVNmRYSnNLR1JoZEdFNmFXMWhaMlV2Y0c1bk8ySmhjMlUyTkN4cFZrSlBVbmN3UzBkbmIwRkJRVUZPVTFWb1JWVm5RVUZCUTFGQlFVRkJhMEpCVFVGQlFVRlVURz',
			'lYY2tGQlFVRkliRUpOVmtWVlFVRkJRVmRCVVVWbFFWRkZiRUZuU1hSQlowbEJRVUZDWVVKUlYxWkRVVzFuVjFadWFHczFUMVo0VUVZelFVRkJRVUpZVWxOVWJFMUJRVUZCUVVGTlNuSkNja1ZCUVVGQ1pGTlZVa0pXU0dobFdYaHBlVmxDVXpSRGJVRkpkVmxXYVdsSlZ6Rm',
			'9VVzkzYURSWlIwbDNiWEJ3Y1ZkR2FIQmhXR3gzV1dkb1NtaERUVGxNVEhsNWRreHJXVkZaUjBWUVZFMXpka3Q1ZVVKRFEweEhlVGxHVWxWVGVHcEVNSFJLVkc5UlNVbExObGxHVVdkVlVWWnhWRUpNVlZKWmIyTkNRVTVCUVVFNWJsVlVVMFpaT1dsQk1FRkJRVUZCVTFWV1',
			'QxSkxOVU5aU1VrOUtTeDFjbXdvWkdGMFlUcHBiV0ZuWlM5d2JtYzdZbUZ6WlRZMExHbFdRazlTZHpCTFIyZHZRVUZCUVU1VFZXaEZWV2RCUVVGRFVVRkJRVUZyUWtGTlFVRkJRVlJNYjFkeVFVRkJRVWhzUWsxV1JWVkJRVUZCU1VGb1oweEJlVUpJVEdjd1FVRkJRVkZCZW',
			'tWcFExZEtXRXhOYmxacGVXWTBNRlpRTkROT1ZreEJRVUZCUWtoU1UxUnNUVUZCUVVGQmN6Vk9iVzFuUVVGQlJrSktVa1ZHVldWR05XcFJRVTlxVVUxUlJrTktlVkZTVmxSalUzTlFURk14VFZWRlEwcE5ZblZZYURWbFdHeFpVVFJKU1ZwaU1EQjJTbmxHZUdOWVdrdEhNRG',
			'hJUzFoNmNHdDZXRkY1VVdoTlNsTlBhMFJCUVZadVNVSlJlVkZvUm5oalFrSnFVWGRUWjBGQlQyUTRSazlPVm5Od1RUZEJRVUZCUVVWc1JsUnJVM1ZSYlVOREtTeDFjbXdvWkdGMFlUcHBiV0ZuWlM5d2JtYzdZbUZ6WlRZMExHbFdRazlTZHpCTFIyZHZRVUZCUVU1VFZXaE',
			'ZWV2RCUVVGRFVVRkJRVUZyUVZGTlFVRkJSR0o2WjNKaVFVRkJRVUV4UWsxV1JWVkJRVUZEYm1WcU0yRkJRVUZCUVZoU1UxUnNUVUZSVDJKWldtZEJRVUZCZEVwU1JVWlZaVVkxYWtkTFdVRkJRVVJaUVVGSFZsRjROalpCUVVGQlFVVnNSbFJyVTNWUmJVTkRLU3gxY213b1',
			'pHRjBZVHBwYldGblpTOXdibWM3WW1GelpUWTBMR2xXUWs5U2R6QkxSMmR2UVVGQlFVNVRWV2hGVldkQlFVRkRVVUZCUVVGclFWRk5RVUZCUkdKNlozSmlRVUZCUVVFeFFrMVdSVlZCUVVGRGJtVnFNMkZCUVVGQlFWaFNVMVJzVFVGUlQySlpXbWRCUVVGQmRFcFNSVVpWWl',
			'VZMWFrZExXVUZCUVVSWlFVRkhWbEY0TmpaQlFVRkJRVVZzUmxSclUzVlJiVU5ES1N4MWNtd29aR0YwWVRwcGJXRm5aUzl3Ym1jN1ltRnpaVFkwTEdsV1FrOVNkekJMUjJkdlFVRkJRVTVUVldoRlZXZEJRVUZEVVVGQlFVRnJRVkZOUVVGQlJHSjZaM0ppUVVGQlFVRXhRaz',
			'FXUlZWQlFVRkRibVZxTTJGQlFVRkJRVmhTVTFSc1RVRlJUMkpaV21kQlFVRkJkRXBTUlVaVlpVWTFha2RMV1VGQlFVUlpRVUZIVmxGNE5qWkJRVUZCUVVWc1JsUnJVM1ZSYlVOREtTeDFjbXdvWkdGMFlUcHBiV0ZuWlM5d2JtYzdZbUZ6WlRZMExHbFdRazlTZHpCTFIyZH',
			'ZRVUZCUVU1VFZXaEZWV2RCUVVGRFVVRkJRVUZyUWtGTlFVRkJRVlJNYjFkeVFVRkJRVXRzUWsxV1JWVkJRVUZCU1VSRFJWbEdlVkZrUjNsVmEwbFRNSFJMVkVVd1RIcEpMMUJVTHk4dkx6aEpSRU5HU2s5VE1UUlpNVTgwYlVkcWJqQktkM2xZYTB0aVFVRkJRVU5ZVWxOVW',
			'JFMUJRVUZCUVVGQlFVRkJRVUo2V2twMWFFRkJRVUYwYTJ4RlVWWlNORmgxTTFCelVUSkRVVUpVUnpoaFQzb3hSMEZDU1RGb1lVOW5TMnh3V25adlFuSmhZWEZPTkVwQkwwTkNRVGhEWWtGSVNVOW5Ta1prWmtKbE9VODBlVloyWmk5NWJETjZTbVV5VERjeFpTOHdTbmxJUl',
			'VwS1NHTlZiM2RqUW1GelRHTlpaWGh3TlVOR2NTdGhaVFJ2VEhGVmRYUXlOWGxxV1hSRlEycGtWSEZuTjFBMmFWVXJVVzlPV0ZJM2NFb3diakZsVEdGak9UTmhNRkY0WjNsTWNpczNSVzFwZW5obk9XaFJjRXRPTlV0NlJrTjVRWFpPVW1ORk1XeFRVa3BDUjJwd1lXMDFhRE',
			'4zVkV4c1ZGbDZTMEpqTlZOUmRHSXdaRGh4TkhGcVMydzRVME5EY1ZBd2JVSmxPVTFVTkZjNVlrUlZVR0kxT0VWQlFVRkJRVk5WVms5U1N6VkRXVWxKUFNrc2RYSnNLR1JoZEdFNmFXMWhaMlV2Y0c1bk8ySmhjMlUyTkN4cFZrSlBVbmN3UzBkbmIwRkJRVUZPVTFWb1JWVm',
			'5RVUZCUTFGQlFVRkJhMEZSVFVGQlFVUmllbWR5WWtGQlFVRkJNVUpOVmtWWU5WRXdUWEEzYm14d1FVRkJRVU13YkVWUlZsSTBXRzFOV1hCblFVRkJUbWRCUVZwV1JFaHliMEZCUVVGQlUxVldUMUpMTlVOWlNVazlLU0krUEhOMGVXeGxQaU56Ylc5c0lIdGlZV05yWjNKdm',
			'RXNWtMWEpsY0dWaGREb2dibTh0Y21Wd1pXRjBPMkpoWTJ0bmNtOTFibVF0YzJsNlpUb2dZMjl1ZEdGcGJqdGlZV05yWjNKdmRXNWtMWEJ2YzJsMGFXOXVPaUJqWlc1MFpYSTdhVzFoWjJVdGNtVnVaR1Z5YVc1bk9pQXRkMlZpYTJsMExXOXdkR2x0YVhwbExXTnZiblJ5WV',
			'hOME95MXRjeTFwYm5SbGNuQnZiR0YwYVc5dUxXMXZaR1U2SUc1bFlYSmxjM1F0Ym1WcFoyaGliM0k3YVcxaFoyVXRjbVZ1WkdWeWFXNW5PaUF0Ylc5NkxXTnlhWE53TFdWa1oyVnpPMmx0WVdkbExYSmxibVJsY21sdVp6b2djR2w0Wld4aGRHVmtPMzA4TDNOMGVXeGxQan',
			'd2YzNablBnPT0iLCJuYW1lIjogIlNtb2wgIzEiLCJhdHRyaWJ1dGVzIjpbeyJ0cmFpdF90eXBlIjoiSVEiLCJ2YWx1ZSI6NTg4LCJkaXNwbGF5X3R5cGUiOiJudW1lcmljIn0seyJ0cmFpdF90eXBlIjoiSVEgUGVuZGluZyIsInZhbHVlIjowLCJkaXNwbGF5X3R5cGUiOi',
			'JudW1lcmljIn0seyJ0cmFpdF90eXBlIjoiSGVhZCBTaXplIiwidmFsdWUiOjAsImRpc3BsYXlfdHlwZSI6Im51bWVyaWMifSx7InRyYWl0X3R5cGUiOiJCYWNrZ3JvdW5kIiwidmFsdWUiOiJyZWQifSx7InRyYWl0X3R5cGUiOiJCb2R5IiwidmFsdWUiOiJicm93biJ9LH',
			'sidHJhaXRfdHlwZSI6IkNsb3RoZXMiLCJ2YWx1ZSI6Im5vbmUifSx7InRyYWl0X3R5cGUiOiJHbGFzc2VzIiwidmFsdWUiOiJub25lIn0seyJ0cmFpdF90eXBlIjoiSGF0IiwidmFsdWUiOiJjYXAtcHVycGxlIn0seyJ0cmFpdF90eXBlIjoiSGFpciIsInZhbHVlIjoibm',
			'9uZSJ9LHsidHJhaXRfdHlwZSI6Ik1vdXRoIiwidmFsdWUiOiJtYXNrIn0seyJ0cmFpdF90eXBlIjoiR2VuZGVyIiwidmFsdWUiOiJtYWxlIn1dfQ==',
		].join(''),
	)
})
